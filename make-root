default: usr/local tmp opt package-list.txt profile

tmp:
	mkdir tmp

package-list.txt: $(HOME)/packages
	rm -rf package-list.txt
	for package in $(HOME)/packages/*.deb; \
	do \
	  echo $$package | tee -a package-list.txt; \
	  dpkg-deb -X $$package ./ >> package-list.txt; \
	done;
	(cd usr/lib/pkgconfig && ~/bin/fix-pkgconfig-prefix.sh)
	(cd usr/lib/i386-linux-gnu/pkgconfig && ~/bin/fix-pkgconfig-prefix.sh)

usr/local:
	mkdir -p usr/local
	ln -s $(HOME)/workspace/make-local usr/local/Makefile

opt:
	mkdir opt
	ln -s $(HOME)/workspace/make-opt opt/Makefile

profile: $(HOME)/settings
	mkdir -p profile
	for dotdir in $(HOME)/settings/.*; \
	do \
	  echo $$dotdir;\
	  mkdir -p `readlink -f $$dotdir`; \
	done;

clean:
	rm -rf *

.PHONY: default clean
